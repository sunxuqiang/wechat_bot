# WeChat Knowledge Base Bot

一个基于知识库的智能问答机器人，支持微信和Web界面交互。

## 主要特性

### 1. 双端支持
- 微信端：通过微信客户端提供智能问答服务
- Web端：提供可视化的知识库管理和查询界面

### 2. 智能搜索
- 多级相似度阈值匹配（0.05, 0.03, 0.01）
- 自适应阈值选择机制
- 向量相似度 + 关键词匹配的混合搜索策略
- 支持中文分词和语义理解

### 3. 知识库管理
- 支持多种文档格式：
  - Microsoft Office（Word, Excel, PowerPoint）
  - PDF文档
  - 文本文件（TXT, Markdown, CSV, JSON）
- 智能文档解析和分块
- 文档增删改查管理
- 实时统计和监控

### 4. 智能应答
- 基于大语言模型的自然语言生成
- 上下文感知的智能回复
- 相关度加权的内容整合
- 无匹配内容时的优雅降级处理

## 技术架构

### 1. 核心组件
- 向量存储：FAISS
- 文本嵌入：
  - 主模型：text2vec-base-chinese
  - 备选模型：all-MiniLM-L6-v2
  - 离线备选：TF-IDF
- 大语言模型：DeepSeek
- Web框架：Flask
- 前端：HTML + JavaScript

### 2. 智能特性
- 多级相似度阈值策略
- 自适应文本分块
- 混合搜索算法
- 智能向量化备选方案
- 动态阈值调整

### 3. 系统优化
- 向量索引优化
- 文档缓存机制
- 批量处理优化
- 错误恢复机制
- 详细的日志记录

## 部署要求

### 环境要求
- Python 3.8+
- Windows 10/11（微信客户端支持）
- 8GB+ RAM建议
- 支持CUDA的GPU（可选，用于加速向量计算）

### 依赖安装
```bash
pip install -r requirements.txt
```

### 配置说明
1. 复制 `.env.example` 为 `.env`
2. 配置必要的环境变量：
   - SILICONFLOW_API_KEY：大语言模型API密钥
   - 其他可选配置项

## 使用说明

### 1. 启动服务
```bash
# 启动Web服务
python app.py

# 启动微信机器人
python wechat_bot.py
```

### 2. Web界面功能
- 文档上传和管理
- 知识库搜索测试
- 系统状态监控
- 配置调整

### 3. 微信机器人功能
- 自动回复知识库内容
- 智能问答服务
- 实时知识检索

## 最近更新

### 1. 搜索优化
- 实现多级相似度阈值策略
- 优化搜索结果排序算法
- 改进中文分词效果
- 增加搜索结果的相关度评分

### 2. 系统优化
- 改进错误处理机制
- 优化日志记录系统
- 增强系统稳定性
- 提升响应速度

### 3. 功能增强
- 完善文档管理功能
- 优化用户交互体验
- 增加系统监控功能
- 改进配置管理

## 开发计划

### 近期计划
- [ ] 支持更多文档格式
- [ ] 优化向量索引性能
- [ ] 改进搜索算法
- [ ] 增加用户反馈机制

### 长期规划
- [ ] 支持分布式部署
- [ ] 添加权限管理
- [ ] 优化资源使用
- [ ] 增加更多AI模型支持

## 贡献指南

欢迎提交Issue和Pull Request来帮助改进项目。

## 许可证

MIT License 
